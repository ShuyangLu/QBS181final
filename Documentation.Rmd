---
title: "Weather Patterns X COVID-19"
subtitle: "Final Project Documentation"
author: "Uhuru Kamau, Shuyang Lu, Yifan Zhao, Chenhao Zhao, Zhaofeng Liu"
date: 
output:
  pdf_document:
    toc: true
    toc_depth: 3
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(tidy = TRUE)
knitr::opts_chunk$set(comment = "RESULT")
```

```{r packages, message=FALSE}
#Load Required Packages
library(tidyverse)
library(kableExtra)
library(readr)
library(gridExtra)
library(knitr)
```

\newpage

```{r, fig.align='left', out.width="200%", out.height="150%", fig.cap="Highlighting the Keys to our Relational Database"}
knitr::include_graphics(path = "QBS181_1.png")
```


# **Data Acquisition**

### 1. New York City COVID-19 Data Archive

+ Source: [\textcolor{blue}{NYC OpenData}](https://data.cityofnewyork.us/Health/COVID-19-Daily-Counts-of-Cases-Hospitalizations-an/rc75-m7u3)

+ Acquisation Method
  + Download .csv file
  
+ Purpose:

  + We will use this time series data to track changes in the incidence of COVID-19.

### 2. New York City Weather Data

+ Source:
[Weather Underground - Weather Archive](https://www.wunderground.com/history/daily/us/ny/new-york-city/KLGA)

+ Acquisition Method

  + Webscraping/ API Tool

+ Purpose:

  + Merge time series weather data with timeseries Covid-19 data and investigate potential associations
  
### 3. Daily UV Index Scores - New York City

+ Source:
[Central New York's Live Weather Source](http://www.cnyweather.com/wxuvdetail.php?r=wxuvdetail.php)

+ Acquisition Method

  + UV index values are presented as tables (see figure)
  
  + Copy tables and paste into Microsoft Excel
  
  + Save as .csv file

+ Purpose

  + Sunlight and Vitamin-D absorbtion

    + It is generally accepted that there is a positive association between exposure to sunlight and absorbtion of vitamin-D. 
  
    + It is also generally accepted that there is a positive association between vitamin-D absorbtion and immune system capacity.
  
  + We will us UV-Index as a proxy for exposure to sunlight at the population level and test for associations between UV Index and the incidence of Covid-19.

\newpage

# Relational Schema

```{r, fig.align='center', out.width="100%", out.height="100%", fig.cap="Highlighting the Keys to our Relational Database"}
knitr::include_graphics(path = "images/Relational_Schema.png")
```

\newpage

# Data Cleaning

### **1. New York City COVID-19 Data Archive**

### **2. New York City Weather Data**

A. Read-in File from Raw Data File

  + The raw file has an issue with the column headers.
  
    + Several Headers include symbols that don't work with the interpretor
    
        + eg. $Low\_Temp\textcolor{red}{(^{o}F)},\ High\_Temp\textcolor{red}{(^{o}F)}$
  
  + \textcolor{green}{Solution:} Update column names while reading in the file!

```{r}
#vector with acceptable column names
headers <- c("High.Temp", "Low.Temp", "Avg.Temp", "Precip",
             "Dew.Point", "Humidity", "Date", "City")

#read in the raw data file
weather.raw <- read.csv(file = "data/Raw Data/nyc_weather_raw.csv",
                        header = TRUE, 
                        col.names = headers) 
```

B. Remove the "City" Variable

  + Every observation is is "new york city"

```{r, eval=FALSE}
weather.clean <- weather.raw %>%
  select(-City)
```

C. Display
```{r}
y = weather.raw[1:5,]
knitr::kable(x = y,digits = 2,align = "c")
```

D. Write the Processed Data to a new .csv file
```{r, eval=FALSE}
write.csv(x = weather.clean,
          file = "data/Processed Data/nyc_weather.csv")
```

### **3. Daily UV Index Scores - New York City**